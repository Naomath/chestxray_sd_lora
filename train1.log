nohup: ignoring input
/home/goto/chestxray_sd_lora/.venv/lib/python3.12/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
  warnings.warn(
/home/goto/chestxray_sd_lora/.venv/lib/python3.12/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
  warnings.warn(
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/home/goto/chestxray_sd_lora/src/train_lora.py", line 266, in <module>
    main()
  File "/home/goto/chestxray_sd_lora/src/train_lora.py", line 160, in main
    _set_lora(unet)
  File "/home/goto/chestxray_sd_lora/src/train_lora.py", line 157, in _set_lora
    lora_attn_procs[name] = LoRAAttnProcessor(rank=lora_rank, network_alpha=lora_alpha, dropout=lora_dropout)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: LoRAAttnProcessor.__init__() got an unexpected keyword argument 'rank'
Traceback (most recent call last):
  File "/home/goto/chestxray_sd_lora/.venv/bin/accelerate", line 10, in <module>
    sys.exit(main())
             ^^^^^^
  File "/home/goto/chestxray_sd_lora/.venv/lib/python3.12/site-packages/accelerate/commands/accelerate_cli.py", line 50, in main
    args.func(args)
  File "/home/goto/chestxray_sd_lora/.venv/lib/python3.12/site-packages/accelerate/commands/launch.py", line 1235, in launch_command
    simple_launcher(args)
  File "/home/goto/chestxray_sd_lora/.venv/lib/python3.12/site-packages/accelerate/commands/launch.py", line 823, in simple_launcher
    raise subprocess.CalledProcessError(returncode=process.returncode, cmd=cmd)
subprocess.CalledProcessError: Command '['/home/goto/chestxray_sd_lora/.venv/bin/python', '-m', 'src.train_lora', '--dataset_dir', '/home/goto/mask_diffusion/data/images/train_normal_256', '--model_id', 'runwayml/stable-diffusion-v1-5', '--output_dir', './outputs/exp1', '--resolution', '256', '--train_batch_size', '16', '--grad_accum_steps', '1', '--mixed_precision', 'bf16', '--learning_rate', '5e-5', '--max_train_steps', '20000', '--lora_rank', '16', '--lora_alpha', '16', '--checkpointing_steps', '1000', '--wandb', '--wandb_project', 'sd_sora_train']' returned non-zero exit status 1.
